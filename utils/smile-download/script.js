let string = `<div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309594.gif);" title='новый год'></div><input type="checkbox" id="smile291" name="smile[]" value="291" ><label for="smile291">:new1:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309603.gif);" title='новый год'></div><input type="checkbox" id="smile292" name="smile[]" value="292" ><label for="smile292">:new2:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309606.gif);" title='новый год'></div><input type="checkbox" id="smile293" name="smile[]" value="293" ><label for="smile293">:new3:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309689.gif);" title='у окна'></div><input type="checkbox" id="smile297" name="smile[]" value="297" ><label for="smile297">:xmas:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309702.gif);" title='ангел рождества'></div><input type="checkbox" id="smile299" name="smile[]" value="299" ><label for="smile299">:xmangel:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309696.gif);" title='колокольчик'></div><input type="checkbox" id="smile298" name="smile[]" value="298" ><label for="smile298">:xmbell:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309681.gif);" title='олень'></div><input type="checkbox" id="smile295" name="smile[]" value="295" ><label for="smile295">:deer1:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309685.gif);" title='тоже олень'></div><input type="checkbox" id="smile296" name="smile[]" value="296" ><label for="smile296">:deer2:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309714.gif);" title='снежинка'></div><input type="checkbox" id="smile300" name="smile[]" value="300" ><label for="smile300">:snezh:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309715.gif);" title='снеговик'></div><input type="checkbox" id="smile301" name="smile[]" value="301" ><label for="smile301">:sneg1:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309718.gif);" title='тоже снеговик'></div><input type="checkbox" id="smile302" name="smile[]" value="302" ><label for="smile302">:sneg2:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309765.gif);" title='елка'></div><input type="checkbox" id="smile303" name="smile[]" value="303" ><label for="smile303">:yolka1:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1336122.gif);" title='елочка, зажгись!'></div><input type="checkbox" id="smile312" name="smile[]" value="312" ><label for="smile312">:yolka11:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1336126.gif);" title='елочка, зажгись!'></div><input type="checkbox" id="smile313" name="smile[]" value="313" ><label for="smile313">:yolka12:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1327646.gif);" title='еще елка'></div><input type="checkbox" id="smile310" name="smile[]" value="310" ><label for="smile310">:yolka3:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1327648.gif);" title='снова елка'></div><input type="checkbox" id="smile311" name="smile[]" value="311" ><label for="smile311">:yolka4:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309768.gif);" title='тоже елка'></div><input type="checkbox" id="smile304" name="smile[]" value="304" ><label for="smile304">:yolka2:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1315456.gif);" title='с новым годом!'></div><input type="checkbox" id="smile305" name="smile[]" value="305" ><label for="smile305">:new5:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1315660.gif);" title='деды морозы'></div><input type="checkbox" id="smile306" name="smile[]" value="306" ><label for="smile306">:moroz:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1315715.gif);" title='дед мороз'></div><input type="checkbox" id="smile307" name="smile[]" value="307" ><label for="smile307">:moroz1:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1320670.gif);" title='дед мороз'></div><input type="checkbox" id="smile308" name="smile[]" value="308" ><label for="smile308">:dm:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1320674.gif);" title='снегурочка'></div><input type="checkbox" id="smile309" name="smile[]" value="309" ><label for="smile309">:sng:</label></div><div class="sml_box"><div class="sml_img"  style="background-image: url(http://static.diary.ru/picture/1309610.gif);" title='новый год'></div><input type="checkbox" id="smile294" name="smile[]" value="294" ><label for="smile294">:new4:</label></div>



`;

var links = string.match(/url\(([^\)]*)gif/g);
links = links.map(a => a.slice(4));

var myregex = /<label for="(.*?)">(.*?)<\/label>/g;
var result,
  ids = [],
  codes = [];
while ((result = myregex.exec(string)) != null) {
  ids.push(result[1]);
  codes.push(result[2]);
}

var download = require('download-file');

let smileInfo = [];
for (let i = 0; i < links.length; i++) {
  smileInfo.push({
    name: ids[i],
    code: codes[i],
    link: links[i],
  });

  var options = {
    directory: './smiles/christmas/',
    filename: ids[i] + '.gif',
  };

  download(links[i], options, function(err) {
    if (err) throw err;
    console.log('meow');
  });
}

console.log(smileInfo);
